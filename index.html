<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOUND NOTES</title>
    <link rel="manifest" href="data:application/manifest+json,{'name':'SoundNotes','short_name':'Notes','start_url':'index.html','display':'standalone'}">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;600&display=swap" rel="stylesheet">
    <style>
        :root { --p: #6366f1; --bg: #f8fafc; }
        body { font-family: 'Kanit', sans-serif; background: var(--bg); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .card { background: white; width: 90%; max-width: 380px; padding: 35px; border-radius: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.05); text-align: center; }
        h2 { color: #1e293b; margin-bottom: 5px; }
        textarea { width: 100%; height: 150px; border: 2px solid #f1f5f9; border-radius: 20px; padding: 15px; font-size: 16px; margin: 20px 0; outline: none; transition: 0.3s; resize: none; box-sizing: border-box; }
        textarea:focus { border-color: var(--p); background: #fff; }
        .btn { width: 100%; padding: 15px; border: none; border-radius: 15px; font-size: 16px; font-weight: 600; cursor: pointer; margin-bottom: 10px; transition: 0.2s; }
        .btn-perm { background: #eef2ff; color: var(--p); }
        .btn-start { background: var(--p); color: white; }
        .btn-stop { background: #f1f5f9; color: #64748b; }
        .status { font-size: 13px; color: #94a3b8; margin-top: 15px; }
    </style>
</head>
<body>

<div class="card">
    <h2>‚ú® SOUND NOTES</h2>
    <p style="color: #64748b; font-size: 14px;">‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å 30 ‡∏ô‡∏≤‡∏ó‡∏µ</p>
    <textarea id="noteInput" placeholder="‡∏à‡∏î‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..."></textarea>
    <button class="btn btn-perm" onclick="requestPermission()">üîì ‡πÄ‡∏õ‡∏¥‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô & ‡πÄ‡∏™‡∏µ‡∏¢‡∏á</button>
    <div style="display: flex; gap: 10px;">
        <button id="startBtn" class="btn btn-start" onclick="startTimer()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</button>
        <button class="btn btn-stop" onclick="stopTimer()">‡∏´‡∏¢‡∏∏‡∏î‡∏û‡∏±‡∏Å</button>
    </div>
    <div id="status" class="status">‚óè ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</div>
</div>

<audio id="sound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3" preload="auto"></audio>

<script>
    let timer;
    const audio = document.getElementById('sound');

    // ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô Service Worker ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏î‡πâ
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('sw.js');
    }

    async function requestPermission() {
        const perm = await Notification.requestPermission();
        if (perm === 'granted') {
            audio.play().then(() => audio.pause());
            alert("‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢! ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô");
        }
    }

    function startTimer() {
    if (Notification.permission !== 'granted') return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö");
    
    // ‚úÖ ‡∏à‡∏∏‡∏î‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏ö‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏¥‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ã‡πâ‡∏≠‡∏ô
    clearInterval(timer); 
    
    sendNotify(); // ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
    
    // ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤ 30 ‡∏ô‡∏≤‡∏ó‡∏µ (1,800,000)
    timer = setInterval(sendNotify, 1800000); 

    const statusDiv = document.getElementById('status');
    statusDiv.innerHTML = "‚óè ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å 30 ‡∏ô‡∏≤‡∏ó‡∏µ";
    statusDiv.style.color = "#10b981";
}

function stopTimer() {
    // ‚úÖ ‡∏™‡∏±‡πà‡∏á‡∏´‡∏¢‡∏∏‡∏î‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    clearInterval(timer); 
    
    const statusDiv = document.getElementById('status');
    statusDiv.innerHTML = "‚óè ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß";
    statusDiv.style.color = "#ef4444"; // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÉ‡∏´‡πâ‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏´‡∏¢‡∏∏‡∏î‡πÅ‡∏•‡πâ‡∏ß
}

    function stopTimer() {
        clearInterval(timer);
        document.getElementById('status').innerText = "‚óè ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô";
        document.getElementById('status').style.color = "#94a3b8";
    }

    function sendNotify() {
        const text = document.getElementById('noteInput').value || "‡πÑ‡∏î‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡πâ‡∏ß!";
        audio.currentTime = 0;
        audio.play();
        
        navigator.serviceWorker.ready.then(reg => {
            reg.showNotification('üìå Reminder!', {
                body: text,
                icon: 'https://cdn-icons-png.flaticon.com/512/564/564619.png',
                vibrate: [200, 100, 200]
            });
        });
    }
</script>
</body>
</html>
